<!-- mypage.html -->
{% extends "layouts/base.html" %} {% block content %}
<style>
  .left-section {
    height: 100vh; /* 사이드바 길이를 늘림 */
  }
  .left-section h3 {
    font-size: 2.5em; /* 사용자명 글씨 크기 */
    margin-bottom: 100px; /* h3와 ul 사이의 간격을 조정 */
  }
  .left-section ul {
    list-style-type: none;
    padding: 0;
  }
  .left-section ul li {
    font-size: 1.5em; /* 목록 글씨 크기 */
    margin-bottom: 50px; /* 목록 사이의 간격 */
  }
  input[type="text"],
  input[type="password"],
  input[type="email"],
  input[type="tel"] {
    width: 60%; /* 폼의 너비 */
    height: 40px; /* 폼의 높이 */
  }
  .row {
    margin-bottom: 40px; /* 각 행의 아래쪽에 마진을 추가 */
  }
  h2 {
    margin-bottom: 50px; /* '계정 설정' 텍스트와 아래 항목들 사이의 간격을 넓힘 */
  }
</style>
<div class="container-fluid">
  <div class="row">
    <!-- Left Sidebar -->
    <div class="left-section col-3 p-4 mb-3 text-secondary shadow">
      <div class="mb-5">
        <h3>{{ user.username }}님</h3>
        <ul>
          <li>스크랩 목록</li>
          <li><a href="#" id="show_account_settings">계정 설정</a></li>
          <li><a href="{{ url_for('auth.delete_account') }}">계정 탈퇴</a></li>
        </ul>
      </div>
    </div>

    <!-- Right Content -->
    <div id="right-content" class="right-section col-9 bg-light text-center">
      <!-- Account Settings Form (Initially hidden) -->
      <div id="account-settings-form" style="display: none">
        <h2>계정 설정</h2>
        <form id="user-update-form">
          <!-- CSRF 토큰 필드 추가 -->
          <input type="hidden" id="csrf_token" value="{{ csrf_token() }}" />

          <div class="row">
            <!-- 첫 번째 행 -->
            <div class="col">
              <label>사용자명</label>
              <input
                type="text"
                id="username"
                value="{{ user.username }}"
                disabled
              />
            </div>
            <div class="col">
              <label>ID</label>
              <input
                type="text"
                id="user_id"
                value="{{ user.user_id }}"
                disabled
              />
            </div>
          </div>

          <!-- 두 번째 행 -->
          <div class="row">
            <div class="col">
              <label>새로운 비밀번호</label>
              <input type="password" id="password" />
            </div>
            <div class="col">
              <label>Email</label>
              <input type="email" id="email" value="{{ user.email }}" />
            </div>
          </div>

          <!-- 세 번째 행 -->
          <div class="row">
            <div class="col">
              <label>새로운 비밀번호 확인</label>
              <input type="password" id="confirm_password" />
            </div>
            <div class="col">
              <label>Phone</label>
              <input type="tel" id="phone" value="{{ user.phone }}" />
            </div>
          </div>

          <!-- 네 번째 행 -->
          <div class="row">
            <div class="col">
              <label>Address</label>
              <input type="text" id="address" value="{{ user.address }}" />
            </div>
          </div>

          <a
            herf="{{ url_for('mypage.update_user_info', user_id=user.user_id) }}"
            class="btn"
            id="update-info"
            >회원정보수정</a
          >
        </form>
      </div>
    </div>
  </div>
</div>
<script>
  // 계정 설정을 클릭했을 때 폼을 표시합니다.
  document
    .getElementById("show_account_settings")
    .addEventListener("click", function () {
      document.getElementById("account-settings-form").style.display = "block";
    });

  // // 회원정보 수정 버튼을 눌렀을 때
  // document.getElementById("update-info").addEventListener("click", function () {
  //   // 여기서는 예시로 AJAX를 사용하여 서버에 정보를 보냅니다.
  //   var xhr = new XMLHttpRequest();
  //   xhr.open("POST", "/update_user_info"); // 업데이트를 처리하는 서버의 URL
  //   xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

  //   // CSRF 토큰 헤더에 추가
  //   xhr.setRequestHeader(
  //     "X-CSRFToken",
  //     document.getElementById("csrf_token").value
  //   );

  //   xhr.send(
  //     JSON.stringify({
  //       user_id: document.getElementById("username").value,
  //       user_pw: document.getElementById("password").value,
  //       email: document.getElementById("email").value,
  //       phone: document.getElementById("phone").value,
  //       address: document.getElementById("address").value,
  //     })
  //   );

  //   xhr.onreadystatechange = function () {
  //     if (xhr.readyState == 4 && xhr.status == 200) {
  //       alert("계정 정보가 수정되었습니다."); // 성공 메시지
  //     }
  //   };
  // });
</script>
{% endblock %}
